"use strict";(self.webpackChunkipyobservable=self.webpackChunkipyobservable||[]).push([[261,608],{767:(e,t,n)=>{n.r(t),n.d(t,{ObservableModel:()=>i.t,ObservableView:()=>i.Q,version:()=>r.i8});var i=n(175);const r={i8:"0.1.1"}},261:(e,t,n)=>{n.r(t),n.d(t,{default:()=>o,observableWidgetPlugin:()=>r});var i=n(767);const r={id:"ipyobservable:plugin",requires:[n(672).IJupyterWidgetRegistry],activate:function(e,t){t.registerWidget({name:"ipyobservable",version:i.version,exports:{ObservableModel:i.ObservableModel,ObservableView:i.ObservableView}})},autoStart:!0},o=r},175:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Q:()=>ObservableView,t:()=>ObservableModel});var _jupyter_widgets_base__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(672),_jupyter_widgets_base__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_jupyter_widgets_base__WEBPACK_IMPORTED_MODULE_0__),_observablehq_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(242),_observablehq_runtime__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_observablehq_runtime__WEBPACK_IMPORTED_MODULE_1__),_unofficial_observablehq_compiler__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(757);class ObservableModel extends _jupyter_widgets_base__WEBPACK_IMPORTED_MODULE_0__.DOMWidgetModel{defaults(){return{...super.defaults(),_model_name:"ObservableModel",_view_name:"ObservableView",_model_module:"ipyobservable",_view_module:"ipyobservable",_model_module_version:"0.1.0",_view_module_version:"0.1.0",_runtime:new _observablehq_runtime__WEBPACK_IMPORTED_MODULE_1__.Runtime,_compile:new _unofficial_observablehq_compiler__WEBPACK_IMPORTED_MODULE_2__.Si,_nodes:[],code:""}}}class ObservableView extends _jupyter_widgets_base__WEBPACK_IMPORTED_MODULE_0__.DOMWidgetView{render(){if(this.runtime=this.model.get("_runtime"),this.compile=this.model.get("_compile"),this.nodes=this.model.get("_nodes"),0===this.nodes.length)this.code_changed();else for(let e of this.nodes)this.el.appendChild(e);this.model.on("change:code",this.code_changed,this)}code_changed(){const code=this.model.get("code"),compiled_code=this.compile.module(code);eval(compiled_code);const main=this.runtime.module(this.define,(e=>{const t=document.createElement("DIV");return this.el.appendChild(t),this.nodes.push(t),new _observablehq_runtime__WEBPACK_IMPORTED_MODULE_1__.Inspector(t)}))}}},757:(e,t,n)=>{n.d(t,{Si:()=>u});var i=n(639),r=n(608);function o(e){if(e.body&&e.body.specifiers)return e.body.specifiers.map((e=>`${e.view?"viewof ":e.mutable?"mutable ":""}${e.local.name}`));if(e.id&&e.id.type&&e.id){if("ViewExpression"===e.id.type)return[`viewof ${e.id.id.name}`];if("MutableExpression"===e.id.type)return[`mutable ${e.id.id.name}`];if(e.id.name)return[e.id.name]}return[]}function s(e){return e.references?e.references.map((e=>e.name?e.name:"ViewExpression"===e.type?`viewof ${e.id.name}`:"MutableExpression"===e.type?`mutable ${e.id.name}`:null)):e.body&&e.body.injections?e.body.injections.map((e=>`${e.view?"viewof ":e.mutable?"mutable ":""}${e.imported.name}`)):[]}function a(e,t={}){const{resolveImportPath:n,resolveFileAttachments:o,defineImportMarkdown:s,observeViewofValues:a,observeMutableValues:l,UNSAFE_allowJavascriptFileAttachments:c}=t,{importSrc:u,importMap:p}=function(e,t){const n=new Map;let i="",r=0;for(const{body:o}of e.cells){if("ImportDeclaration"!==o.type||n.has(o.source.value))continue;const e="define"+ ++r,s=o.specifiers.map((e=>`${e.view?"viewof ":e.mutable?"mutable ":""}${e.imported.name}`)),a=t(o.source.value,s);n.set(o.source.value,{defineName:e,fromPath:a}),i+=`import ${e} from "${a}";\n`}return i.length&&(i+="\n"),{importSrc:i,importMap:n}}(e,n);return`${u}function define(runtime, observer) {\n  const main = runtime.module();\n${function(e,t,n=!1){let i;if(n){const n=[];for(const i of e.cells)if(0!==i.fileAttachments.size)for(const e of i.fileAttachments.keys())n.push([e,t(e)]);n.length&&(i=`[${n.map((([e,t])=>`[${JSON.stringify(e)}, ${t}]`)).join(",")}]`)}else{const n=[];for(const i of e.cells)if(0!==i.fileAttachments.size)for(const e of i.fileAttachments.keys())n.push([e,t(e)]);n.length&&(i=JSON.stringify(n))}return i?`  const fileAttachments = new Map(${i});\n  main.builtin("FileAttachment", runtime.fileAttachments(name => fileAttachments.get(name)));`:""}(e,o,c)}\n${function(e,t,n){const{defineImportMarkdown:o,observeViewofValues:s,observeMutableValues:a}=n;let l=0;return e.cells.map((e=>{let n="";if("ImportDeclaration"===e.body.type){const{specifiers:i,hasInjections:r,injections:s,importString:a}=function(e){const t=[];if(e.body.specifiers)for(const n of e.body.specifiers)n.view?t.push({name:"viewof "+n.imported.name,alias:"viewof "+n.local.name}):n.mutable&&t.push({name:"mutable "+n.imported.name,alias:"mutable "+n.local.name}),t.push({name:n.imported.name,alias:n.local.name});const n=void 0!==e.body.injections,i=[];if(n)for(const t of e.body.injections)t.view?i.push({name:"viewof "+t.imported.name,alias:"viewof "+t.local.name}):t.mutable&&i.push({name:"mutable "+t.imported.name,alias:"mutable "+t.local.name}),i.push({name:t.imported.name,alias:t.local.name});const r=`import {${t.map((e=>`${e.name} as ${e.alias}`)).join(", ")}} ${n?`with {${i.map((e=>`${e.name} as ${e.alias}`)).join(", ")}} `:""}from "${e.body.source.value}"`;return{specifiers:t,hasInjections:n,injections:i,importString:r}}(e);o&&(n+=`  main.variable(observer()).define(\n    null,\n    ["md"],\n    md => md\`~~~javascript\n${a}\n~~~\`\n  );\n`);const c="child"+ ++l;n+=`  const ${c} = runtime.module(${t.get(e.body.source.value).defineName})${r?`.derive(${JSON.stringify(s)}, main)`:""};\n${i.map((e=>`  main.import("${e.name}", "${e.alias}", ${c});`)).join("\n")}`}else{const{cellName:t,references:o,bodyText:l,cellReferences:c}=function(e){let t=null;e.id&&e.id.name?t=e.id.name:e.id&&e.id.id&&e.id.id.name&&(t=e.id.id.name);let n=e.input.substring(e.body.start,e.body.end);const o=(e.references||[]).map((e=>"ViewExpression"===e.type?"viewof "+e.id.name:"MutableExpression"===e.type?"mutable "+e.id.name:e.name));let s=0,a=0;const l=(e.references||[]).map((t=>{if("ViewExpression"===t.type){const t="$"+s;return s++,(0,r.lC)(e.body,{ViewExpression(i){const r=i.start-e.body.start,o=i.end-e.body.start;n=n.slice(0,r+a)+t+n.slice(o+a),a+=t.length-(o-r)}},i.walk),t}if("MutableExpression"===t.type){const t="$"+s,o=t+".value";return s++,(0,r.lC)(e.body,{MutableExpression(t){const i=t.start-e.body.start,r=t.end-e.body.start;n=n.slice(0,i+a)+o+n.slice(r+a),a+=o.length-(r-i)}},i.walk),t}return t.name}));return{cellName:t,references:Array.from(new Set(l)),bodyText:n,cellReferences:Array.from(new Set(o))}}(e),u=t?`"${t}"`:"",p=o.join(",");let m="";m="BlockStatement"!==e.body.type?`{return(\n${l}\n)}`:"\n"+l+"\n";const f=c.length?JSON.stringify(c)+", ":"";let d="";if(d=e.generator&&e.async?`async function*(${p})${m}`:e.async?`async function(${p})${m}`:e.generator?`function*(${p})${m}`:`function(${p})${m}`,e.id&&"ViewExpression"===e.id.type){const e=`"viewof ${t}"`;n+=`  main.variable(observer(${e})).define(${e}, ${f}${d});\n  main.variable(${s?`observer("${t}")`:"null"}).define("${t}", ["Generators", ${e}], (G, _) => G.input(_));`}else if(e.id&&"MutableExpression"===e.id.type){const e=`"initial ${t}"`,i=`"mutable ${t}"`;n+=`  main.define(${e}, ${f}${d});\n  main.variable(observer(${i})).define(${i}, ["Mutable", ${e}], (M, _) => new M(_));\n  main.variable(${a?`observer("${t}")`:"null"}).define("${t}", [${i}], _ => _.generator);`}else n+=`  main.variable(observer(${u})).define(${t?u+", ":""}${f}${d});`}return n})).join("\n")}(e,p,{defineImportMarkdown:s,observeViewofValues:a,observeMutableValues:l})||""}\n  return main;\n}\nthis.define = define;`}function l(e){const t=(e=>{let t,n=e;return(t=/\.js(\?|$)/i.exec(n))&&(n=n.slice(0,t.index)),(t=/^[0-9a-f]{16}$/i.test(n))&&(n=`d/${n}`),(t=/^https:\/\/(api\.|beta\.|)observablehq\.com\//i.exec(n))&&(n=n.slice(t[0].length)),n})(e);return`https://api.observablehq.com/${t}.js?v=3`}function c(e){return e}class u{constructor(e={}){const{resolveFileAttachments:t=c,resolveImportPath:n=l,defineImportMarkdown:i=!0,observeViewofValues:r=!0,observeMutableValues:o=!0,UNSAFE_allowJavascriptFileAttachments:s=!1}=e;this.resolveFileAttachments=t,this.resolveImportPath=n,this.defineImportMarkdown=i,this.observeViewofValues=r,this.observeMutableValues=o,this.UNSAFE_allowJavascriptFileAttachments=s}module(e,t={}){let n="string"==typeof e?(0,i.parseModule)(e):e;return t.treeShake&&(n=function(e,t){const n=function(e){const t=[];for(const n of e.cells){const e=o(n),i=s(n);if(e&&e.length)for(const n of e)t.push([n,i]),n.startsWith("viewof ")&&t.push([n.substring("viewof ".length),[n]])}return new Map(t)}(e),i=new Set,r=t.slice();for(;r.length;){const e=r.pop();if(i.add(e),!n.has(e))continue;const t=n.get(e);for(const e of t)i.has(e)||r.push(e)}return{cells:e.cells.filter((e=>o(e).filter((e=>i.has(e))).length))}}(n,t.treeShake)),a(n,{resolveImportPath:this.resolveImportPath,resolveFileAttachments:this.resolveFileAttachments,defineImportMarkdown:this.defineImportMarkdown,observeViewofValues:this.observeViewofValues,observeMutableValues:this.observeMutableValues,UNSAFE_allowJavascriptFileAttachments:this.UNSAFE_allowJavascriptFileAttachments})}notebook(e){return a({cells:e.nodes.map((({value:e})=>{const t=(0,i.parseCell)(e);return t.input=e,t}))},{resolveImportPath:this.resolveImportPath,resolveFileAttachments:this.resolveFileAttachments,defineImportMarkdown:this.defineImportMarkdown,observeViewofValues:this.observeViewofValues,observeMutableValues:this.observeMutableValues})}}Object.getPrototypeOf((async function(){})).constructor,Object.getPrototypeOf((function*(){})).constructor,Object.getPrototypeOf((async function*(){})).constructor},608:(e,t,n)=>{function i(e,t,n,i,r){n||(n=c),function e(i,r,o){var s=o||i.type,a=t[s];n[s](i,r,e),a&&a(i,r)}(e,i,r)}function r(e,t,n,i,r){var o=[];n||(n=c),function e(i,r,s){var a=s||i.type,l=t[a],c=i!==o[o.length-1];c&&o.push(i),n[a](i,r,e),l&&l(i,r||o,o),c&&o.pop()}(e,i,r)}n.d(t,{Sy:()=>s,lC:()=>i,so:()=>r});var o=Object.create||function(e){function t(){}return t.prototype=e,new t};function s(e,t){var n=o(t||c);for(var i in e)n[i]=e[i];return n}function a(e,t,n){n(e,t)}function l(e,t,n){}var c={};c.Program=c.BlockStatement=function(e,t,n){for(var i=0,r=e.body;i<r.length;i+=1)n(r[i],t,"Statement")},c.Statement=a,c.EmptyStatement=l,c.ExpressionStatement=c.ParenthesizedExpression=c.ChainExpression=function(e,t,n){return n(e.expression,t,"Expression")},c.IfStatement=function(e,t,n){n(e.test,t,"Expression"),n(e.consequent,t,"Statement"),e.alternate&&n(e.alternate,t,"Statement")},c.LabeledStatement=function(e,t,n){return n(e.body,t,"Statement")},c.BreakStatement=c.ContinueStatement=l,c.WithStatement=function(e,t,n){n(e.object,t,"Expression"),n(e.body,t,"Statement")},c.SwitchStatement=function(e,t,n){n(e.discriminant,t,"Expression");for(var i=0,r=e.cases;i<r.length;i+=1){var o=r[i];o.test&&n(o.test,t,"Expression");for(var s=0,a=o.consequent;s<a.length;s+=1)n(a[s],t,"Statement")}},c.SwitchCase=function(e,t,n){e.test&&n(e.test,t,"Expression");for(var i=0,r=e.consequent;i<r.length;i+=1)n(r[i],t,"Statement")},c.ReturnStatement=c.YieldExpression=c.AwaitExpression=function(e,t,n){e.argument&&n(e.argument,t,"Expression")},c.ThrowStatement=c.SpreadElement=function(e,t,n){return n(e.argument,t,"Expression")},c.TryStatement=function(e,t,n){n(e.block,t,"Statement"),e.handler&&n(e.handler,t),e.finalizer&&n(e.finalizer,t,"Statement")},c.CatchClause=function(e,t,n){e.param&&n(e.param,t,"Pattern"),n(e.body,t,"Statement")},c.WhileStatement=c.DoWhileStatement=function(e,t,n){n(e.test,t,"Expression"),n(e.body,t,"Statement")},c.ForStatement=function(e,t,n){e.init&&n(e.init,t,"ForInit"),e.test&&n(e.test,t,"Expression"),e.update&&n(e.update,t,"Expression"),n(e.body,t,"Statement")},c.ForInStatement=c.ForOfStatement=function(e,t,n){n(e.left,t,"ForInit"),n(e.right,t,"Expression"),n(e.body,t,"Statement")},c.ForInit=function(e,t,n){"VariableDeclaration"===e.type?n(e,t):n(e,t,"Expression")},c.DebuggerStatement=l,c.FunctionDeclaration=function(e,t,n){return n(e,t,"Function")},c.VariableDeclaration=function(e,t,n){for(var i=0,r=e.declarations;i<r.length;i+=1)n(r[i],t)},c.VariableDeclarator=function(e,t,n){n(e.id,t,"Pattern"),e.init&&n(e.init,t,"Expression")},c.Function=function(e,t,n){e.id&&n(e.id,t,"Pattern");for(var i=0,r=e.params;i<r.length;i+=1)n(r[i],t,"Pattern");n(e.body,t,e.expression?"Expression":"Statement")},c.Pattern=function(e,t,n){"Identifier"===e.type?n(e,t,"VariablePattern"):"MemberExpression"===e.type?n(e,t,"MemberPattern"):n(e,t)},c.VariablePattern=l,c.MemberPattern=a,c.RestElement=function(e,t,n){return n(e.argument,t,"Pattern")},c.ArrayPattern=function(e,t,n){for(var i=0,r=e.elements;i<r.length;i+=1){var o=r[i];o&&n(o,t,"Pattern")}},c.ObjectPattern=function(e,t,n){for(var i=0,r=e.properties;i<r.length;i+=1){var o=r[i];"Property"===o.type?(o.computed&&n(o.key,t,"Expression"),n(o.value,t,"Pattern")):"RestElement"===o.type&&n(o.argument,t,"Pattern")}},c.Expression=a,c.ThisExpression=c.Super=c.MetaProperty=l,c.ArrayExpression=function(e,t,n){for(var i=0,r=e.elements;i<r.length;i+=1){var o=r[i];o&&n(o,t,"Expression")}},c.ObjectExpression=function(e,t,n){for(var i=0,r=e.properties;i<r.length;i+=1)n(r[i],t)},c.FunctionExpression=c.ArrowFunctionExpression=c.FunctionDeclaration,c.SequenceExpression=function(e,t,n){for(var i=0,r=e.expressions;i<r.length;i+=1)n(r[i],t,"Expression")},c.TemplateLiteral=function(e,t,n){for(var i=0,r=e.quasis;i<r.length;i+=1)n(r[i],t);for(var o=0,s=e.expressions;o<s.length;o+=1)n(s[o],t,"Expression")},c.TemplateElement=l,c.UnaryExpression=c.UpdateExpression=function(e,t,n){n(e.argument,t,"Expression")},c.BinaryExpression=c.LogicalExpression=function(e,t,n){n(e.left,t,"Expression"),n(e.right,t,"Expression")},c.AssignmentExpression=c.AssignmentPattern=function(e,t,n){n(e.left,t,"Pattern"),n(e.right,t,"Expression")},c.ConditionalExpression=function(e,t,n){n(e.test,t,"Expression"),n(e.consequent,t,"Expression"),n(e.alternate,t,"Expression")},c.NewExpression=c.CallExpression=function(e,t,n){if(n(e.callee,t,"Expression"),e.arguments)for(var i=0,r=e.arguments;i<r.length;i+=1)n(r[i],t,"Expression")},c.MemberExpression=function(e,t,n){n(e.object,t,"Expression"),e.computed&&n(e.property,t,"Expression")},c.ExportNamedDeclaration=c.ExportDefaultDeclaration=function(e,t,n){e.declaration&&n(e.declaration,t,"ExportNamedDeclaration"===e.type||e.declaration.id?"Statement":"Expression"),e.source&&n(e.source,t,"Expression")},c.ExportAllDeclaration=function(e,t,n){e.exported&&n(e.exported,t),n(e.source,t,"Expression")},c.ImportDeclaration=function(e,t,n){for(var i=0,r=e.specifiers;i<r.length;i+=1)n(r[i],t);n(e.source,t,"Expression")},c.ImportExpression=function(e,t,n){n(e.source,t,"Expression")},c.ImportSpecifier=c.ImportDefaultSpecifier=c.ImportNamespaceSpecifier=c.Identifier=c.Literal=l,c.TaggedTemplateExpression=function(e,t,n){n(e.tag,t,"Expression"),n(e.quasi,t,"Expression")},c.ClassDeclaration=c.ClassExpression=function(e,t,n){return n(e,t,"Class")},c.Class=function(e,t,n){e.id&&n(e.id,t,"Pattern"),e.superClass&&n(e.superClass,t,"Expression"),n(e.body,t)},c.ClassBody=function(e,t,n){for(var i=0,r=e.body;i<r.length;i+=1)n(r[i],t)},c.MethodDefinition=c.Property=function(e,t,n){e.computed&&n(e.key,t,"Expression"),n(e.value,t,"Expression")}}}]);